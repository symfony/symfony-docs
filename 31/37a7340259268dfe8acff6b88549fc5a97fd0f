---------------------------------------------------------------------------

by javiereguiluz at 2018-02-06T09:15:38Z

@xabbuh thanks for the review. To be 100% sure about the code, I created an snippet and run it to double check the results.
